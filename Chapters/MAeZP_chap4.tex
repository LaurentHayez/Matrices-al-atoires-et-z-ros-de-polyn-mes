%-----------------------------------------------------------------------%
%______//------ Matrices aléatoires et zéros de polynômes ------\\______%
%______||------                Chapitre 4                ------||______%
%______\\------  ------//______%
%-----------------------------------------------------------------------%

\chapter{Graphes de \textsc{Ramanujan}}
\label{cha:graph-de-ramanujan}

\section{Théorie algébrique des graphes}
\label{sec:theor-algebr-des-graphes}

Un \emph{\index{graphe}graphe} fini est une paire $X = (V,E)$ composé d'un ensemble $V$ de sommets (\og
vertices\fg{} en anglais) et $E \subset V \times V$ d'arêtes (\og edges\fg{} en anglais). On supposera dans le
cours qu'on a au plus une arête entre deux sommets (i.e. on n'a pas de multigraphe), qu'on n'a pas de boucle,
et on considère que les arêtes ne sont pas orientés (i.e. si $e = (v,w) \in E$, $e' = (w,v) \in E$).

On dit qu'un graphe est \emph{\index{graphe!connexe}connexe} s'il existe un chemin entre toute paire de sommet de
$V$.

On met la \index{relation d'adjacence}relation d'adjacence $x \sim y \iff \{x, y\} \in E$, et la \emph{\index{matrice
d'adjacence}matrice d'adjacence} $A$ est indexée par les paires de sommets 
\[ A_{xy} =
  \begin{cases}
    1 & \text{si } x \sim y\\
    0 & \text{si } x \not\sim y
  \end{cases}
\]

L'application linéaire correspondante $A \colon \C V \to \C V$ (où $\C V$ est l'ensemble des fonctions $f
\colon V \to \C$), qui à $f \in \C V$ associe 
\[ (A f)(x) = \sum_{y \colon y \sim x}^{}f(y). \]

Puisque $A = A^\top$, on sait par l'algèbre linéaire que le spectre de $A$ $\sigma(A)$ (l'ensemble des valeurs
propres) est réel et $A$ est diagonalisable.

On dit que $X$ est \emph{\index{graphe!$d$-régulier}$d$-régulier} si tout sommet a $d$ voisins.

On dit que $X$ est \emph{\index{graphe!biparti}biparti} ou \emph{\index{graphe!bicolorable}bicolorable} si et
seulement si $V = V_1 \sqcup V_2$ tq 
\[ x \sim y \implies
  \begin{cases}
    x \in V_1 \text{ et } y \in V_2\\
    \text{ou}\\
    x \in V_2 \text{ et } y \in V_1.
  \end{cases}
\]

\begin{prop}
  Soit $X$ un graphe $d$-régulier, connexe fini. Alors
  \begin{enumerate}
  \item si $\lambda$ est une valeur propre de $A$, alors $|\lambda| \leq d$~;
  \item $d$ est valeur propre de multiplicité $1$~;
  \item $-d$ est valeur propre de $A$ ssi $X$ est biparti (ou bicolorable), et dans ce cas $\sigma(A)$ est
    symétrique par rapport à $0$ ($\lambda \in \sigma(A) \implies -\lambda \in \sigma(A)$).
  \end{enumerate}

\end{prop}


\begin{preuve}
  \begin{enumerate}
  \item Soit $\lambda \in \sigma(A)$ et soit $f$ la fonction propre associée à $\lambda$. Soit $x_0 \in V$ tel
    que $|f(x_0)| \geq |f(x)|$ pour tout $x \in V$. On a 
    \[ |\lambda||f(x_0)| = |\lambda f(x_0)| = |Af(x_0)| = \left| \sum_{y \sim x_0}^{}f(y) \right| \leq
      \underbrace{\sum_{y\sim x_0}^{}|f(y)|}_{d \text{ termes}} \leq d|f(x_0)|,\]
    et donc (puisque $f$ est une fonction propre non nulle)
    \[ |\lambda| \leq d. \]

    
  \item Soit $f \equiv 1$ sur $V$, alors $Af = df$ et 
    \[ Af(x) = \sum_{y \sim x}^{} f(y) = d. \]
    Soit à présent $f$ la fonction propre associée à $d$. On veut montrer qu'alors $f$ est constante. On peut
    supposer $f$ à valeurs réelles (car on peut séparer parties réelles et imaginaires). Soit $x_0 \in V$ un sommet qui réalise 
    \[ |f(x_0)| \geq |f(x)|\ \forall x \in V. \]
    Quitte à remplacer $f$ par $-f$, on peut supposer que $f(x_0) > 0$. On a 
    \[ df(x_0) = Af(x_0) = \sum_{y \sim x_0}^{} f(y).  \]
    Ainsi 
    \[ f(x_0) = \frac{1}{d} \sum_{y \sim x_0}^{}f(y), \]
    i.e. on peut voir $f(x_0)$ comme la moyenne de $f$ sur les $d$ voisins. Mais puisque $f(x_0)$ est un
    maximum, on a que $f(y) = f(x_0)$ pour tout $y \sim x_0$. En continuant ainsi, par connexité, $f$ est
    constante. On voit encore que $d$ est de multiplicité $1$ car l'espace propre associé est de dimension $1$.

  \item Soit $X$ biparti. Alors on prend 
    \[ f(x) =
      \begin{cases}
        1 & \text{si } x \in V_1,\\
        -1 & \text{si } x \in V_2.
      \end{cases}
    \]
    Soit $x \in V_1$ pour le moment, alors
    \[ (Af)(x) \sum_{y \sim x}^{} f(y) = -d = -df(x).\]
    Symétriquement, on a la même chose si $x \in V_2$. Ainsi on conclut que 
    \[ Af = -df. \]

    La réciproque ($-d$ valeur propre implique $X$ est biparti) est un exercice.

    Soit encore $X$ biparti et soit $\lambda \in \sigma(\lambda)$, soit $g$ une \index{fonction propre }fonction propre associée à
    $\lambda$ ($Ag = \lambda g$) et considérons 
    \[ f(x) = \begin{cases}
        g(x) & \text{si } x \in V_1,\\
        -g(x)& \text{si } x \in V_2.
      \end{cases} \]
    Vérifions que $Af = -\lambda f$. Soit $x \in V_1$. Alors 
    \[ (Af)(x) = \sum_{y \sim x}^{} f(\underbrace{y}_{\in V_2}) = -\sum_{y \sim x}^{} g(y) = -(Ag)(x) =
      -\lambda g(x) = -\lambda f(x).\]
    Si $x \in V_2$, on a la même conclusion. Ainsi on a bien 
    \[ Af = -\lambda f. \]
  \end{enumerate}
\end{preuve}


Soit $X$ un graphe fini connexe $d$-régulier à $n$ sommets. On range les valeurs propres de $A$ par ordre
décroissant, en tenant compte des multiplicités. On note la plus grande valeur propre $\mu_0 = d$ et on a
(puisque $d$ est de multiplicité $1$) 
\[ \mu_0 = d > \mu_1 \geq \mu_2 \geq \cdots \geq \mu_{n-1} (\geq -d). \]
Le \emph{\index{trou spectral}trou spectral} du graphe est 
\[ d - \mu_1. \]

\begin{defi}
  Un graphe $d$-régulier connexe fini est \emph{\index{graphe!de \textsc{Ramanujan}}de \textsc{Ramanujan}} si 
  \[ \mu_1 \leq 2 \sqrt{d - 1}. \]
\end{defi}

MAUVAISE DÉFINITION~! LA BONNE DÉFINITION EST LA DÉFINITION \ref{defi:graphe-de-ramanujan}.


\begin{exs}
  \begin{enumerate}
  \item Pour $d = 2$~: les graphes $2$-réguliers connexes finis sont les cycles. L'inégalité $\mu_1 \leq 2$
    est triviale.
  \item Le \index{graphe!complet}graphe complet $K_n$ sur $n$ sommets (i.e. tout sommet est relié avec tout
    autre) est $(n-1)$-régulier. Soit $J_n$ la matrice $n \times n$ remplie de $1$. Ainsi 
    \[ A = J_n - \un_n, \]
    on a de plus 
    \[ J_n = n J_n \implies \left(\frac{J_n}{n}\right)^2 = \frac{J_n}{n}. \]
    Ainsi la matrice $\frac{J_n}{n}$ est une matrice de projection, donc $\sigma\left( \frac{J_n}{n} \right) =
    \{0,1\}$. Ainsi $\sigma(J_n) = \{0,n\}$. Ainsi on en déduit que 
    \[ \sigma(A) = \left\{-1, n-1\right\} \]
    et $-1 = \mu_1$.
  \end{enumerate}
\end{exs}

\paragraph{D'où sort $2\sqrt{d-1}$?}

\begin{itemize}
\item Un graphe connexe $X$ sans cycle est un \emph{\index{arbre}arbre}. Soit $T_d$ l'arbre $d$-régulier (donc
  $T_d$ est infini). Par exemple, $T_{2d}$ est le graphe de Cayley de $\mathbb{F}_d$. De plus, $T_d$ est le
  revêtement universel de tout graphe $d$-régulier connexe.

  Si $A$ est la matrice d'adjacence de $T_d$, on peut voir $A$ comme un opérateur borné sur $\ell^2(T_d)$ et
  $A = A^\ast$, et
  \[ \sigma(A) = \left[ -2 \sqrt{d-1}, 2 \sqrt{d-1} \right]. \] Ce résultat est dû à Harry \textsc{Kesten},
  1959 (une partie de sa thèse).

  
\item Soit $(X_n)_{n > 0}$ une suite de graphes $d$-réguliers, connexes, finis, $|V_n| \xrightarrow{n \to
    \infty} \infty$. L'\index{inégalité d'\textsc{Alon-Boppana}}inégalité d'\textsc{Alon-Boppana} ($\sim$ 1984) dit 
  \[ \liminf_{n \to \infty} \mu_1(X_n) \geq 2 \sqrt{d-1}. \]
\end{itemize}

On peut interpréter ceci en disant que les graphes de Ramanujan sont les graphes \og qui ont le plus grand
trou spectral possible\fg{} asymptotiquement.

Cela pose le problème de l'existence de familles infinies de graphes de Ramanujan $d$-réguliers pour $d >
2$. En 1986, A. \textsc{Lubotzky}, R. \textsc{Phillips} et P. \textsc{Sarnak} (équipe américaine) (indépendamment
G. \textsc{Margulis} pour l'équipe de Russie) ont construit des familles infinies de graphes de Ramanujan
$d$-réguliers, pour $d$ de la forme $p^{k}+1$, $p$ premier et $k \geq 1$. Pour ce faire, ils ont utilisé la
conjecture de Ramanujan (1916) en théorie des nombres qui avait été démontrée en 1974 par Pierre \textsc{Deligne}
(médaille Fields en 1978, comme \textsc{Margulis}).

\paragraph{Question:}

Pour quelles valeurs de $d$ existe-t-il des familles infinies de graphes de Ramanujan $d$-réguliers?


Bonne définition d'un graphe de Ramanujan: 
\begin{defi}
  \label{defi:graphe-de-ramanujan}
  Un graphe fini, connexe et $d$-régulier est \emph{\index{de \textsc{Ramanujan}}de \textsc{Ramanujan}} si
  pour toute valeur propre $\mu$ de $A$ , on a $|\mu| = d$ ou 
  \[ |\mu| \leq 2 \sqrt{d - 1}. \]
\end{defi}

Interprétation: on a toujours la valeur propre $\mu = d$, $\mu = -d$ est là ssi $X$ est bicolorable et les autres
valeurs propre dans le cas Ramanujan sont dans l'intervalle $\left[-2\sqrt{d-1}, 2\sqrt{d-1}\right]$.

Pour revenir à la question posée précédemment, LPS ont montré que pour $d = 1 + p^k$ ($p$ premier), il y a des
constructions \textit{explicites} de familles infinies de graphes de Ramanujan $d$-réguliers, à la fois
bicolorables et non bicolorables.

\begin{theo}[MSS, 2013]
  Pour tout $d \geq 3$, il existe des familles infinies, non explicites, de graphes de Ramanujan $d$-réguliers bicolorables.
\end{theo}

\paragraph{Problème ouvert:}

Même chose en remplaçant bicolorable par non bicolorable.

Les technique de MSS leur permettent de contrôler \og le haut du spectre\fg{} de $A$. L'hypothèse que $X$ est
biparti leur permet de contrôler également le \og bas du spectre\fg{}, puisque dans ce cas, le spectre est
symétrique.


\section{$2$-relèvements (\og $2$-lifts\fg{})}
\label{sec:2-relevements}


\begin{defi}
  Soit $X=(V,E)$ un graphe fini. Un \emph{\index{signage}signage} de $X$ est une fonction 
  \[ s \colon V \times V \to \{-1, 0, 1\} \]
  qui est symétrique (i.e. $s(x,y) = s(y,x)$) et telle que 
  \[ s(x,y) \neq 0 \iff x \sim y. \]
\end{defi}

\begin{rem}
  On peut aussi y penser comme une fonction $E \to \{\pm 1\}$.
\end{rem}

Si $s$ est un signage de $X$, la \emph{\index{matrice d'adjacence signée}matrice d'adjacence signée} 
\[ (A^{(s)})_{xy} = s(x,y) \quad (x,y \in V). \]
Ainsi en mettant le signage constante ($s(x,y) = 1$ si $x \sim y$), c'est la matrice d'adjacence usuelle.

Si $|V| = n$ et $s$ est un signage de $X$, le \emph{\index{$2$-relèvement}$2$-relèvement} de $X$ associé à $s$
est un graphe $\tilde{X}^{(s)}$ à $2n$ sommets, avec $\tilde{V} = V_1 \sqcup V_2$, où $V_1$ et $V_2$ sont des
copies de $V$.
\begin{itemize}
\item Si $xy \in E$ et $s(x,y) = 1$, soient $x_1 \in V_1$, $x_2, \in V_2$ les sommets correspondants à $x \in
  V$, et $y_1 \in V_1$, $y_2 \in V_2$ les sommets correspondants à $y \in V$. Alors on relie $x_1$ à $y_1$
  dans $V_1$ et
  $x_2$ à $y_2$ dans $V_2$.
\item Si $xy \in E$ et $s(x,y) = -1$, soient $x_1 \in V_1$, $x_2, \in V_2$ les sommets correspondants à $x \in
  V$, et $y_1 \in V_1$, $y_2 \in V_2$ les sommets correspondants à $y \in V$. Alors on relie $x_1$ à $y_2$
  dans $V_1 \times V_2$ et
  $x_2$ à $y_1$ dans $V_2 \times V_1$.
\end{itemize}

\begin{exs}
  \begin{enumerate}
  \item Si $s(x,y) = 1$ si $x \sim y$, alors $\tilde{X}^{(s)}$ est formé de deux copies de $X$ (non connexe).
  \item Si $X = C_n$, $s(x,y) = 1$ pour chaque arête sauf $1$, le graphe est connexe~: $\tilde{X}^{(s)} \simeq
    C_{2n}$ (faire le dessin pour se convaincre).
  \end{enumerate}
\end{exs}

\begin{exercice}
  \begin{enumerate}
  \item Si $X$ est $d$-régulier, alors $\tilde{X}^{(s)}$ aussi.
  \item Si $X$ est biparti, alors $\tilde{X}^{(s)}$ aussi.
  \end{enumerate}
\end{exercice}


\begin{lem}[Y. \textsc{Bilu}, N. \textsc{Linial}, 2006]
  Soit $\tilde{A}^{(s)}$ la matrice d'adjacence de $\tilde{X}^{(s)}$ (de taille $2n \times 2n$). Alors 
  \[ \sigma(\tilde{A}^{s}) = \sigma(A) \cup \sigma(A^{(s)}). \]
\end{lem}

\begin{preuve}
  Décomposons $\tilde{A}^{(s)}$ selon la $1$ère et la $2$ème copie de $V$
  \[ 
    \tilde{A}^{(s)} =
    \begin{pmatrix}
      A_1 & A_2 \\ A_2 & A_1
    \end{pmatrix}
  \]
  où $(A_1)_{xy} = 1$ ssi $x \sim y$ et $s(x,y) = 1$ et $(A_2)_{xy} = 1$ ssi $x \sim y$ et $s(x,y) = -1$.

  Alors $A = A_1 + A_2$, et $A^{(s)} = A_1 - A_2$. Si $v$ est un vecteur propre de $A$, de valeur propre
  $\mu$, $Av = \mu v$, alors 
  \[ \tilde{A}^{(s)}
    \begin{pmatrix}
      v \\ v
    \end{pmatrix} =
    \begin{pmatrix}
      A_1v + A_2 v\\ A_2v + A_1v
    \end{pmatrix} =
    \begin{pmatrix}
      Av \\ Av
    \end{pmatrix} = \mu
    \begin{pmatrix}
      v \\ v
    \end{pmatrix}
  \]
  et donc $\sigma(A) \subset \sigma(\tilde{A}^{(s)})$.

  Si $u$ est un vecteur propre de $A^{(s)}$, de valeur propre $\lambda$, $A^{(s)} \lambda = u\lambda$. Alors 
  \[ \tilde{A}^{(s)}
    \begin{pmatrix}
      u\\ - u
    \end{pmatrix}
    =
    \begin{pmatrix}
      A_1 u - A_2 u\\ A_2u - A_1 u
    \end{pmatrix}
    =
    \begin{pmatrix}
      A^{(s)} u\\ - A^{(s)}u
    \end{pmatrix}
    =
    \begin{pmatrix}
      \lambda u\\ - \lambda u
    \end{pmatrix}
    = \lambda
    \begin{pmatrix}
      u \\ -u
    \end{pmatrix}.
  \]
  et donc $\sigma(A^{(s)}) \subset \sigma(\tilde{A}^{(s)})$. Mais puisque $
  \begin{pmatrix}
    v\\v
  \end{pmatrix} \perp
  \begin{pmatrix}
    u\\ -u
  \end{pmatrix}$. Mais en comptant les multiplicités, les $\binom{v}{v}$ engendrent un sous-espace de
  dimension $n$, les $\binom{u}{-u}$ aussi (qui est orthogonal au précédent), donc on a trouvé une base de
  vecteurs propres de $\tilde{A}^{(s)}$, et il n'y a pas d'autre valeur propre.
\end{preuve}

\paragraph{Conséquence:} Si $X$ est $d$-régulier, alors $\sigma(A^{(s)}) \subset [-d, d]$.

\paragraph{Observation:} Si $X$ est $d$-régulier Ramanujan, et $s$ est un signage tel que $\sigma(A^{(s)})
\subset \left[-2\sqrt{d-1}, 2\sqrt{d-1}\right]$, alors $\tilde{X}^{(s)}$ est Ramanujan. En effet,
$\tilde{X}^{(s)}$ est connexe car la multiplicité de la valeur propre $d$ vaut $1$ et les valeurs propres
venant de $A^{(s)}$ sont toutes dans $\left[ -2 \sqrt{d-1}, 2 \sqrt{d-1}\right]$, donc (par le Lemme),
$\tilde{X}^{(s)}$ est Ramanujan.


\begin{conj}[de \textsc{Bilu-Linial}, 2006]
  Si $X$ est $d$-régulier, alors il existe un signage $s$ de $X$ avec 
  \[ \sigma(A^{(s)}) \subset \left[-2 \sqrt{d-1}, 2\sqrt{d-1}\right]. \]
\end{conj}

\begin{theo}[MSS]
  \label{theo:3}
  La conjecture de Bilu-Linial est vraie pour un graphe $d$-régulier biparti.
\end{theo}

\begin{rem}
  La conjecture est toujours ouverte pour le cas non biparti.
\end{rem}

\begin{conseq}
  Il existe des familles infinies de graphes de Ramanujan $d$-réguliers bipartis.
\end{conseq}


L'observation et le Théorème \ref{theo:3} montrent que, si $X$ est $d$-régulier, bicolorable et Ramanujan,
alors $X$ possède un signage $s$ tel que $\tilde{X}^{(s)}$ est $d$-régulier, biparti et Ramanujan. On peut
itérer. On démarre avec le graphe biparti complet $K_{d,d}$.

\section{Preuve du Théorème \ref{theo:3}}.


Soit $X$ $d$-régulier, biparti, à $n$ sommets et $m$ arêtes. Soit $s$ un signage de $X$, et $e = \{u, v\} \in
E$, on définit une matrice positive de rang $1$: $A_e^{(s)}\geq 0$. Si $s(u,v) = 1$, 
\[ (A_e^{(s)})_{xy} =
  \begin{cases}
    1 & \text{si } x, y \in \{u,v\},\\
    0 & \text{si } x \text{ ou } y \notin \{u,v\}.
  \end{cases}
\]
Si $f \colon V \to \C$, 
\[ A_e^{(s)}(f) = \left \langle f\, ,\, \delta_u + \delta_v \right \rangle(\delta_u + \delta_v).  \]
Si $s(u,v) = -1$, alors
\[ (A_e^{(s)})_{xy} =
  \begin{cases}
    1 & \text{si } x = y = u \text{ ou } x = y = v,\\
    -1 & \text{si } (x=u \text{ et } y = v) \text{ ou } (x=v \text{ et } y = u),\\
    0 & \text{si } x \notin \{u,v\} \text{ ou } y \notin \{u,v\}.
  \end{cases}
\]
On a
\[ A_e^{(s)}(f) = \left \langle f\, ,\, \delta_u - \delta_v \right \rangle(\delta_u - \delta_v).  \]
Alors 
\[ \sum_{e \in E}^{}A_e^{(s)} = A^{(s)} + d \un_n. \]

\begin{preuve}[du Théorème \ref{theo:3}]

\end{preuve}




































%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../MAeZP_cours.tex" 
%%% End: